<Window x:Class="MediaMetadataEditor.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:MediaMetadataEditor.Core"
        xmlns:local="clr-namespace:MediaMetadataEditor.Helpers"
        Title="Media Metadata Editor" Height="760" Width="1200" WindowStartupLocation="CenterScreen">
    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <DockPanel LastChildFill="True" Margin="10">
        <ToolBarTray DockPanel.Dock="Top">
            <ToolBar>
                <Button Content="Add" Command="{Binding CmdAddFiles}" />
                <Button Content="Remove" Command="{Binding CmdRemoveSelected}" />
                <Button Content="Clear" Command="{Binding CmdClear}" />
                <Button Content="Dedup" Command="{Binding CmdDedupe}" />
                <Separator/>
                <Button Content="Preview" Command="{Binding CmdPreviewSelected}" />
                <Button Content="Apply" Command="{Binding CmdApply}" />
                <Separator/>
                <Button Content="Theme" Command="{Binding CmdToggleTheme}" />
                <Button Content="Open capability" Command="{Binding CmdOpenCapability}" />
            </ToolBar>
            <ToolBar HorizontalAlignment="Right">
                <TextBlock VerticalAlignment="Center" Margin="6,0" Text="Presets:"/>
                <ComboBox Width="220" ItemsSource="{Binding Presets}" DisplayMemberPath="Name" SelectedItem="{Binding SelectedPreset}" />
                <Button Content="Save" Command="{Binding CmdSavePreset}" />
                <Button Content="Delete" Command="{Binding CmdDeletePreset}" />
            </ToolBar>
        </ToolBarTray>

        <Grid Margin="0,8,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2.2*" />
                <ColumnDefinition Width="3*" />
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="{DynamicResource PanelBrush}" CornerRadius="6" Padding="8">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                        <CheckBox Content="Show hidden fields" IsChecked="{Binding ShowHiddenFields}" Command="{Binding CmdToggleShowHidden}" Margin="4"/>
                        <TextBlock Text="{Binding Files.Count, StringFormat=Files: {0}}" VerticalAlignment="Center" Margin="10,0"/>
                    </StackPanel>

                    <ListBox x:Name="FilesList" ItemsSource="{Binding Files}" DisplayMemberPath="FileName"
                             local:SelectedItemsBehavior.SelectedItems="{Binding SelectedFiles}" SelectionMode="Extended"
                             Margin="0,8,0,0">
                        <ListBox.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Preview" Command="{Binding CmdPreviewSelected}" />
                                <MenuItem Header="Remove" Command="{Binding CmdRemoveSelected}" />
                            </ContextMenu>
                        </ListBox.ContextMenu>
                    </ListBox>

                    <TextBlock Text="{Binding StatusText}" Margin="6,8,0,0" Foreground="{DynamicResource TextSecondaryBrush}" />
                </DockPanel>
            </Border>

            <Border Grid.Column="1" Background="{DynamicResource PanelBrush}" CornerRadius="6" Padding="12" Margin="12,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <ItemsControl ItemsSource="{Binding FieldViewModels}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <DockPanel Margin="0,6">
                                        <CheckBox IsChecked="{Binding IsChecked}" IsEnabled="{Binding IsEnabled}" ToolTip="{Binding Tooltip}" VerticalAlignment="Center" Width="28"/>
                                        <Label Content="{Binding DisplayName}" Width="160" Margin="6,0"/>
                                        <TextBox Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" Width="420" Margin="6,0" VerticalAlignment="Center"/>
                                    </DockPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                            <Button Content="Apply to selected" Command="{Binding CmdApply}" Width="160"/>
                            <Button Content="Remove substring..." Command="{Binding CmdRemoveSubstring}" Width="160" Margin="8,0"/>
                            <Button Content="Restore backup" Command="{Binding CmdRestoreFromBackup}" Width="160" Margin="8,0"/>
                            <Button Content="Export report" Command="{Binding CmdExportReport}" Width="140" Margin="8,0"/>
                        </StackPanel>

                        <Separator Margin="0,12"/>
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Content="Create backup" IsChecked="{Binding CreateBackup}" Margin="0,0,12,0"/>
                            <CheckBox Content="Attempt experimental fields" IsChecked="{Binding AllowExperimental}" />
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <StatusBar DockPanel.Dock="Bottom" Height="26">
            <StatusBarItem><TextBlock Text="{Binding StatusText}" /></StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right"><TextBlock Text="MediaMetadataEditor â€” v1.0" /></StatusBarItem>
        </StatusBar>
    </DockPanel>
</Window>
